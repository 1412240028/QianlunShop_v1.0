<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Konfirmasi Pesanan - QianlunShop</title>
  
  <!-- Styles -->
  <link rel="stylesheet" href="../css/main.css">
  <link rel="icon" href="../assets/images/icons/QianLun Alphabet.png" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Prevent caching for this page -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <!-- Scripts -->
  <script type="module" src="../js/script-final.js" defer></script>
  
  <style>
    /* Page-specific styles */
    body {
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      min-height: 100vh;
    }

    .order-confirmation-section {
      padding: 2rem 1rem;
      min-height: calc(100vh - 140px);
    }

    .order-confirmation-section .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Loading Animation */
    .confirmation-loading {
      text-align: center;
      padding: 5rem 2rem;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(212, 175, 55, 0.2);
      border-top: 4px solid #d4af37;
      border-radius: 50%;
      margin: 0 auto 1.5rem;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .confirmation-loading p {
      color: #a0a0a0;
      font-size: 1.1rem;
      font-family: 'Inter', sans-serif;
    }

    /* Receipt appears animation */
    .receipt-wrapper {
      animation: receiptSlideIn 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    @keyframes receiptSlideIn {
      from {
        opacity: 0;
        transform: translateY(40px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Smooth scroll */
    html {
      scroll-behavior: smooth;
    }

    /* Hide print button on print */
    @media print {
      .navbar,
      footer,
      .confirmation-actions,
      .additional-actions,
      .help-section {
        display: none !important;
      }

      body {
        background: white;
      }

      .receipt-wrapper {
        box-shadow: none;
        border: 1px solid #ddd;
        page-break-inside: avoid;
      }
    }

    /* Mobile optimization */
    @media (max-width: 768px) {
      .order-confirmation-section {
        padding: 1rem 0.5rem;
      }

      body {
        padding-top: 65px;
      }
    }

    /* Prevent flash of unstyled content */
    .order-confirmation {
      min-height: 400px;
    }

    /* Success page specific */
    .page-fade-in {
      animation: pageFadeIn 0.6s ease;
    }

    @keyframes pageFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>

<body class="page-fade-in">
  
  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo">
      <a href="../index.html">
        <img src="../assets/images/icons/QianLun Alphabet.png" alt="QianLun Logo" class="logo-img">
      </a>
    </div>

    <button class="mobile-menu-btn" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <ul>
      <li><a href="../index.html">Beranda</a></li>
      <li><a href="products.html">Produk</a></li>
      <li>
        <a href="cart.html" id="cartIcon">
          Keranjang <span class="cart-count">0</span>
        </a>
      </li>
      <li><a href="about.html">Tentang</a></li>
      <li><a href="contact.html">Kontak</a></li>
    </ul>
  </nav>

  <!-- Order Confirmation Section -->
  <section class="section order-confirmation-section">
    <div class="container">
      <!-- Content will be dynamically populated by JavaScript -->
      <div class="order-confirmation">
        <!-- Initial loading state -->
        <div class="confirmation-loading">
          <div class="loading-spinner"></div>
          <p>‚è≥ Memuat data pesanan Anda...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>QIANLUNSHOP</h4>
          <p>Where Heritage Meets Modern Luxury</p>
        </div>
        
        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="../index.html">Beranda</a></li>
            <li><a href="products.html">Koleksi</a></li>
            <li><a href="about.html">Tentang Kami</a></li>
            <li><a href="contact.html">Kontak</a></li>
          </ul>
        </div>
        
        <div class="footer-section">
          <h4>Contact</h4>
          <p>üìß hello@qianlunshop.com</p>
          <p>üì± +62 812-3456-7890</p>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p>¬© 2025 <span>QianlunShop</span>. Semua hak dilindungi.</p>
        <p>Desain oleh <strong>Dhoni Prasetya</strong></p>
      </div>

      <!-- Security Badge -->
      <div class="security-badge">
        <p>üîí Transaksi Aman & Terenkripsi</p>
      </div>
    </div>
  </footer>

  <!-- Toast Container (for notifications) -->
  <div id="luxury-toast-container"></div>

  <!-- Inline Scripts for immediate functionality -->
  <script>
    // Prevent back button after order completion
    window.history.pushState(null, "", window.location.href);
    window.onpopstate = function() {
      window.history.pushState(null, "", window.location.href);
    };

    // Check if order data exists on page load
    window.addEventListener('DOMContentLoaded', function() {
      const orderData = localStorage.getItem('qianlunshop_last_order');
      
      if (!orderData) {
        console.warn('‚ö†Ô∏è No order data found on page load');
      } else {
        console.log('‚úÖ Order data exists on page load');
      }
    });

    // Prevent accidental page refresh
    let formSubmitted = false;
    window.addEventListener('beforeunload', function(e) {
      if (!formSubmitted) {
        const confirmationMessage = 'Data pesanan Anda akan hilang jika Anda meninggalkan halaman ini.';
        e.returnValue = confirmationMessage;
        return confirmationMessage;
      }
    });

    // Mark as submitted when navigating away intentionally
    document.addEventListener('click', function(e) {
      const link = e.target.closest('a');
      if (link && link.href) {
        formSubmitted = true;
      }
    });
  </script>

  <!-- Debug helper (remove in production) -->
  <script>
    // Debug: Show order data in console
    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
      console.log('=== ORDER CONFIRMATION DEBUG ===');
      const orderData = localStorage.getItem('qianlunshop_last_order');
      if (orderData) {
        console.log('Order Data:', JSON.parse(orderData));
      } else {
        console.warn('No order data found in localStorage');
      }
      console.log('================================');
    }
  </script>

</body>
</html>